
模型 radio_cnn_vit特征提取 ->交叉注意力 -> mlp分类

结构
分支一：CNN  + 传统组学特征

| 输入图像                           | 输入维度            | 输出维度        |
| ------------------------------ | --------------- | ----------- |
| 输入图像                           | (B,3,224,224)   |             |
| ResNet-18特征提取                  | (B,3,224,224)   | (B,512,7,7) |
| AdaptiveAvgPool + Flatten      | (B,512,7,7)     | (B,512)     |
| 传统特征归一化                        | (B,93)          | (B,93)      |
| 特征拼接 [ResNet, 传统特征]            | (B,512), (B,93) | (B,605)     |
| 融合层: Linear(605→768)+LayerNorm | (B,605)         | (B,768)     |


```mermaid
graph TD
    A[Input Image 3x224x224] --> B[ResNet-18 Backbone]
    B --> C[512x7x7 Feature Map]
    C --> D[AdaptiveAvgPool + Flatten]
    D --> E[ResNet Feature 512D]
    E --> F[Concat with Traditional Features]
    G[Traditional Features 93D] --> H[BatchNorm1d]
    H --> F
    F --> I[Fused Feature 605D]
    I --> J[Fuse Layer: Linear+LayerNorm]
    J --> K[Final Feature 768D]
```


分支二：

| 输入图像                          | 输入维度          | 输出维度          |
| ----------------------------- | ------------- | ------------- |
| 输入图像                          | (B,3,224,224) |               |
| Conv2d(3→768,16x16, stride16) | (B,3,224,224) | (B,768,14,14) |
| Flatten(2) → Permute          | (B,768,14,14) | (B,196,768)   |
| LayerNorm                     | (B,196,768)   | (B,196,768)   |
| 添加CLS Token                   | (B,196,768)   | B,197,768)    |
| 加入位置编码                        | (B,197,768)   | (B,197,768)   |
| Transformer编码                 | (B,197,768)   | (B,197,768)   |
|                               |               |               |
```mermaid
graph TD
    A[Input Image 3x224x224] --> B[Conv2d 16x16 Stride 16]
    B --> C[768x14x14 Feature]
    C --> D[Flatten & Permute]
    D --> E[Sequence 196x768D]
    E --> F[LayerNorm]
    F --> G[Add CLS Token 197x768D]
    G --> H[Positional Encoding]
    H --> I[Transformer Encoder]
    I --> J[Final ViT Features 197x768D]
```


CrossAttentionFuser模块

| ResNet特征输入                         | (B,768)                |           |
| ---------------------------------- | ---------------------- | --------- |
| Expand Dimension                   | (B,768)                | (B,1,768) |
| Cross-Attention(Q=ResNet, K/V=ViT) | (B,1,768), (B,197,768) | (B,1,768) |
| Squeeze Dimension                  | (B,1,768)              | (B,768)   |
| 获取ViT的CLS Token                    | (B,197,768)            | (B,768)   |
| 融合CLS Token与注意力输出                  | (B,768), (B,768)       | (B,768)   |
| 分类头: Linear(768→256→2)             | (B,768)                | (B,2)     |
