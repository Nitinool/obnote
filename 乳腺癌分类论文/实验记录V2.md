
数据集 
图片 BUSI
特征数 493
超参数：
```python
class Config:
    batch_size = 32
    num_epochs = 30
    lr = 1e-4
    weight_decay = 1e-4
    early_stop_patience = 10
    device = torch.device("cuda:3" if torch.cuda.is_available() else "cpu")
    model_save_path = "./best_model_hybrid.pth"
    trad_feat_dim = 469  # 根据实际特征维度修改
    num_workers = 8  # 多线程加载数据
    contrast_loss_weight = 0.1  # 强化学习的权重
optimizer = optim.AdamW(model.parameters(), lr=Config.lr, weight_decay=Config.weight_decay) 

criterion_cls = nn.CrossEntropyLoss()
criterion_contrast = DualContrast(moco_size=512, feature_dim=256, temperature=0.1, device=Config.device)
scheduler = optim.lr_scheduler.StepLR(optimizer, step_size=3, gamma=0.7)
```

我想先尝试解决训练过拟合的思路 

vits-16 -> 196,384 
resnet18  -> 196,384
trad -> 196,384
cros_att: vits-16+trad -> 196,384
cros_att: resnet18+trad -> 196,384
selt_att:  vits-16|resnet18 -> 196,768 
- 尝试其他融合方式（如基于单 token 的跨注意力）。
- 添加注意力权重可视化以分析融合效果。


模型结构 


|       | 准确率  | AUC  |
| ----- | ---- | ---- |
| V2-C2 | 9153 | 9275 |
| V2-C3 | 8692 | 9164 |

思路一 在原始780数据集上 通过简单图像变换翻倍恶性数据集
优化：
1.**动态对比损失权重**
2.模型正则化 添加 L2 正则化到传统特征投影 增加 Dropout
3.ViT 和 ResNet 计算量大，考虑使用更轻量的骨干（如 MobileNetV3 或 EfficientNet-B0）替换 ResNet18


|       | 准确率 AUC                                                              | c_loss | batch_size | lr       |
| ----- | -------------------------------------------------------------------- | ------ | ---------- | -------- |
| V2-C4 | 0.9012 0.9357                                                        | 0.1    |            |          |
| V2-C4 | Sensitivity: 0.8810 Specificity: 0.8182 AUC: 0.9290 Accuracy: 0.8488 | 0.5    | 32         |          |
|       | Sensitivity: 0.7500 Specificity: 0.9545 AUC: 0.9589 Accuracy: 0.8547 | 0.3    | 32         |          |
|       | Sensitivity: 0.7619 Specificity: 0.9886 AUC: 0.9320 Accuracy: 0.8779 | 0.2    | 32         |          |
|       | Sensitivity: 0.7857 Specificity: 0.9545 AUC: 0.9221 Accuracy: 0.8721 | 0.2    | 32         |          |
|       | Sensitivity: 0.8571 Specificity: 0.8750 AUC: 0.9069 Accuracy: 0.8663 | 0.2    | 16         |          |
| V2-C5 | Sensitivity: 0.8690 Specificity: 0.8977 AUC: 0.9386 Accuracy: 0.8837 | 0.1    | 32         |          |
|       | Sensitivity: 0.8095 Specificity: 0.9318 AUC: 0.9154 Accuracy: 0.8721 | 0.1    | 32         |          |
| V2-C5 | Sensitivity: 0.8333 Specificity: 0.9545 AUC: 0.9383 Accuracy: 0.8953 | 0.1    | 32         | 这一版比较稳定  |
|       | Sensitivity: 0.8452 Specificity: 0.9659 AUC: 0.9547 Accuracy: 0.9070 | 0.1    | 32         |          |
|       | Sensitivity: 0.7619 Specificity: 0.9773 AUC: 0.9386 Accuracy: 0.9077 |        |            |          |
|       | Sensitivity: 0.8571 Specificity: 0.9659 AUC: 0.9226 Accuracy: 0.9308 |        |            | 93传统组学特征 |

scheduler = optim.lr_scheduler.ReduceLROnPlateau(optimizer, mode='min', factor=0.7, patience=3)

c6 数据集重新增强

|     |     |
| --- | --- |
|     |     |



思路二 传统组学特征替换为LBP Wavelet LoG的特征 然后GAN生成图像完善数据不平衡 对比学习引导特征空间

思路三 

